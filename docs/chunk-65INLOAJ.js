import{b as k,d as _,e as j,k as tt}from"./chunk-6Q6YHIRJ.js";import{b as N}from"./chunk-WCPZFELE.js";import{C as $}from"./chunk-AJGGPJRP.js";import{i as X}from"./chunk-3MOYO27G.js";import"./chunk-UXCDS6QA.js";import"./chunk-7D3XAEE7.js";import"./chunk-CG2EMPLA.js";import"./chunk-CTLUDKZB.js";import"./chunk-GSTDJRCA.js";import"./chunk-YVA7YSBN.js";import"./chunk-3WGOZNFF.js";import"./chunk-QGXACWGO.js";var st=function(n,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(n):a?a.value:e.get(n)},it=function(n,e,t,a,i){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t},S;function q(n){let e=({register:t})=>t(n);try{window.dispatchEvent(new F(e))}catch(t){console.error(`wallet-standard:register-wallet event could not be dispatched
`,t)}try{window.addEventListener("wallet-standard:app-ready",({detail:t})=>e(t))}catch(t){console.error(`wallet-standard:app-ready event listener could not be added
`,t)}}var F=class extends Event{get detail(){return st(this,S,"f")}get type(){return"wallet-standard:register-wallet"}constructor(e){super("wallet-standard:register-wallet",{bubbles:!1,cancelable:!1,composed:!1}),S.set(this,void 0),it(this,S,e,"f")}preventDefault(){throw new Error("preventDefault cannot be called")}stopImmediatePropagation(){throw new Error("stopImmediatePropagation cannot be called")}stopPropagation(){throw new Error("stopPropagation cannot be called")}};S=new WeakMap;var rt={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},E={mainnet:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedMainnet:"4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ",devnet:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedDevnet:"8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"};function ot(n){return rt[n]||[]}function lt(n){return{methods:ot(n),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}}function et(n){return n.reduce((e,t)=>{let{id:a,chainNamespace:i,rpcUrls:o}=t,d=o.default.http[0];e[i]||(e[i]=lt(i));let h=`${i}:${a}`,r=e[i];switch(r?.chains.push(h),h){case E.mainnet:r.chains.push(E.deprecatedMainnet);break;case E.devnet:r.chains.push(E.deprecatedDevnet);break;default:}return r?.rpcMap&&d&&(r.rpcMap[a]=d),e},{})}var p=["solana:mainnet","solana:devnet","solana:testnet","solana:localnet"];var g=function(n,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(n):a?a.value:e.get(n)},D=function(n,e,t,a,i){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t},C,z,L,W,v,I,x=class{get address(){return g(this,C,"f")}get publicKey(){return g(this,z,"f").slice()}get chains(){return g(this,L,"f").slice()}get features(){return g(this,W,"f").slice()}get label(){return g(this,v,"f")}get icon(){return g(this,I,"f")}constructor({address:e,publicKey:t,label:a,icon:i}){C.set(this,void 0),z.set(this,void 0),L.set(this,void 0),W.set(this,void 0),v.set(this,void 0),I.set(this,void 0),D(this,C,e,"f"),D(this,z,t,"f"),D(this,L,p,"f"),D(this,W,["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"],"f"),D(this,v,a,"f"),D(this,I,i,"f")}};C=new WeakMap,z=new WeakMap,L=new WeakMap,W=new WeakMap,v=new WeakMap,I=new WeakMap;function b(n){return p.includes(n)}function A(n){return"version"in n}var s=function(n,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(n):a?a.value:e.get(n)},y=function(n,e,t,a,i){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t},m,u,H,c,O,K,l,R,B,at,T,U,Y,G,Z,Q,V,P;function ct(n){return{"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"solana:mainnet","solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ":"solana:mainnet","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"solana:testnet","solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K":"solana:devnet","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":"solana:devnet"}[n]}var J=class n{static register(e){let t=new n(e);q(t)}get version(){return s(this,H,"f")}get name(){return s(this,O,"f")}get icon(){return s(this,K,"f")}get chains(){return p.slice()}get features(){return{"standard:connect":{version:"1.0.0",connect:s(this,G,"f")},"standard:disconnect":{version:"1.0.0",disconnect:s(this,Z,"f")},"standard:events":{version:"1.0.0",on:s(this,R,"f")},"solana:signAndSendTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:s(this,Q,"f")},"solana:signTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:s(this,V,"f")},"solana:signMessage":{version:"1.0.0",signMessage:s(this,P,"f")}}}get accounts(){let e=s(this,c,"f").session?.namespaces?.solana,t=e?.chains?.map(a=>ct(a));return e?.accounts.map(a=>{let{address:i}=X.parseCaipAddress(a),o=new k(N.decode(i));return{address:i,publicKey:o.toBytes(),chains:t,features:["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"]}})||[]}constructor(e){m.add(this),u.set(this,{}),H.set(this,"1.0.0"),c.set(this,void 0),O.set(this,"WalletConnect"),K.set(this,"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE4NSIgdmlld0JveD0iMCAwIDMwMCAxODUiIHdpZHRoPSIzMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTYxLjQzODU0MjkgMzYuMjU2MjYxMmM0OC45MTEyMjQxLTQ3Ljg4ODE2NjMgMTI4LjIxMTk4NzEtNDcuODg4MTY2MyAxNzcuMTIzMjA5MSAwbDUuODg2NTQ1IDUuNzYzNDE3NGMyLjQ0NTU2MSAyLjM5NDQwODEgMi40NDU1NjEgNi4yNzY1MTEyIDAgOC42NzA5MjA0bC0yMC4xMzY2OTUgMTkuNzE1NTAzYy0xLjIyMjc4MSAxLjE5NzIwNTEtMy4yMDUzIDEuMTk3MjA1MS00LjQyODA4MSAwbC04LjEwMDU4NC03LjkzMTE0NzljLTM0LjEyMTY5Mi0zMy40MDc5ODE3LTg5LjQ0Mzg4Ni0zMy40MDc5ODE3LTEyMy41NjU1Nzg4IDBsLTguNjc1MDU2MiA4LjQ5MzYwNTFjLTEuMjIyNzgxNiAxLjE5NzIwNDEtMy4yMDUzMDEgMS4xOTcyMDQxLTQuNDI4MDgwNiAwbC0yMC4xMzY2OTQ5LTE5LjcxNTUwMzFjLTIuNDQ1NTYxMi0yLjM5NDQwOTItMi40NDU1NjEyLTYuMjc2NTEyMiAwLTguNjcwOTIwNHptMjE4Ljc2Nzc5NjEgNDAuNzczNzQ0OSAxNy45MjE2OTcgMTcuNTQ2ODk3YzIuNDQ1NTQ5IDIuMzk0Mzk2OSAyLjQ0NTU2MyA2LjI3NjQ3NjkuMDAwMDMxIDguNjcwODg5OWwtODAuODEwMTcxIDc5LjEyMTEzNGMtMi40NDU1NDQgMi4zOTQ0MjYtNi40MTA1ODIgMi4zOTQ0NTMtOC44NTYxNi4wMDAwNjItLjAwMDAxLS4wMDAwMS0uMDAwMDIyLS4wMDAwMjItLjAwMDAzMi0uMDAwMDMybC01Ny4zNTQxNDMtNTYuMTU0NTcyYy0uNjExMzktLjU5ODYwMi0xLjYwMjY1LS41OTg2MDItMi4yMTQwNCAwLS4wMDAwMDQuMDAwMDA0LS4wMDAwMDcuMDAwMDA4LS4wMDAwMTEuMDAwMDExbC01Ny4zNTI5MjEyIDU2LjE1NDUzMWMtMi40NDU1MzY4IDIuMzk0NDMyLTYuNDEwNTc1NSAyLjM5NDQ3Mi04Ljg1NjE2MTIuMDAwMDg3LS4wMDAwMTQzLS4wMDAwMTQtLjAwMDAyOTYtLjAwMDAyOC0uMDAwMDQ0OS0uMDAwMDQ0bC04MC44MTI0MTk0My03OS4xMjIxODVjLTIuNDQ1NTYwMjEtMi4zOTQ0MDgtMi40NDU1NjAyMS02LjI3NjUxMTUgMC04LjY3MDkxOTdsMTcuOTIxNzI5NjMtMTcuNTQ2ODY3M2MyLjQ0NTU2MDItMi4zOTQ0MDgyIDYuNDEwNTk4OS0yLjM5NDQwODIgOC44NTYxNjAyIDBsNTcuMzU0OTc3NSA1Ni4xNTUzNTdjLjYxMTM5MDguNTk4NjAyIDEuNjAyNjQ5LjU5ODYwMiAyLjIxNDAzOTggMCAuMDAwMDA5Mi0uMDAwMDA5LjAwMDAxNzQtLjAwMDAxNy4wMDAwMjY1LS4wMDAwMjRsNTcuMzUyMTAzMS01Ni4xNTUzMzNjMi40NDU1MDUtMi4zOTQ0NjMzIDYuNDEwNTQ0LTIuMzk0NTUzMSA4Ljg1NjE2MS0uMDAwMi4wMDAwMzQuMDAwMDMzNi4wMDAwNjguMDAwMDY3My4wMDAxMDEuMDAwMTAxbDU3LjM1NDkwMiA1Ni4xNTU0MzJjLjYxMTM5LjU5ODYwMSAxLjYwMjY1LjU5ODYwMSAyLjIxNDA0IDBsNTcuMzUzOTc1LTU2LjE1NDMyNDljMi40NDU1NjEtMi4zOTQ0MDkyIDYuNDEwNTk5LTIuMzk0NDA5MiA4Ljg1NjE2IDB6IiBmaWxsPSIjM2I5OWZjIi8+PC9zdmc+"),l.set(this,null),R.set(this,(t,a)=>(s(this,u,"f")[t]||(s(this,u,"f")[t]=[]),s(this,u,"f")[t].push(a),()=>s(this,m,"m",at).call(this,t,a))),T.set(this,()=>{let t=this.accounts[0];t?.publicKey&&(y(this,l,new x(t),"f"),s(this,m,"m",B).call(this,"change",{accounts:this.accounts}))}),U.set(this,()=>{s(this,l,"f")&&(y(this,l,null,"f"),s(this,m,"m",B).call(this,"change",{accounts:this.accounts}))}),Y.set(this,()=>{s(this,c,"f").session?.namespaces?.solana?.accounts.length?s(this,T,"f").call(this):s(this,U,"f").call(this)}),G.set(this,async()=>(s(this,l,"f")||($.push("ConnectingWalletConnect"),await s(this,c,"f").connect({namespaces:et([tt.DEFAULT_CHAIN])})),s(this,T,"f").call(this),{accounts:this.accounts})),Z.set(this,async()=>{await s(this,c,"f").disconnect()}),Q.set(this,async(...t)=>{if(!s(this,l,"f"))throw new Error("not connected");let a=[];if(t.length===1){let{transaction:i,account:o,chain:d,options:h}=t[0]||{},{minContextSlot:r,preflightCommitment:w,skipPreflight:f,maxRetries:M}=h||{};if(o?.address!==s(this,l,"f")?.address)throw new Error("invalid account");if(!b(d||":"))throw new Error("invalid chain");if(!i)throw new Error("invalid transaction");let nt=await s(this,c,"f").request({method:"solana_signAndSendTransaction",params:{transaction:i,pubkey:s(this,l,"f").address,sendOptions:{preflightCommitment:w,minContextSlot:r,maxRetries:M,skipPreflight:f}}});a.push({signature:N.decode(nt.signature)})}else if(t.length>1){let i=await Promise.all(t.map(o=>s(this,Q,"f").call(this,o)));for(let o of i)a.push(...o)}return a}),V.set(this,async(...t)=>{if(!s(this,l,"f"))throw new Error("not connected");let a=[];if(t.length===1){let{transaction:i,account:o,chain:d}=t[0]||{};if(o?.address!==s(this,l,"f").address)throw new Error("invalid account");if(d&&!b(d))throw new Error("invalid chain");if(!i)throw new Error("invalid transaction");let h=_.from(i),r,w=await s(this,c,"f").request({method:"solana_signTransaction",params:{transaction:i,pubkey:s(this,l,"f").address}});if("signature"in w){let M=N.decode(w.signature);h.addSignature(new k(s(this,l,"f").publicKey),Buffer.from(M)),r=h}else{let M=Buffer.from(w.transaction,"base64");A(h)&&(r=j.deserialize(new Uint8Array(M))),r=_.from(M)}if(!r)throw new Error("invalid transaction");let f=A(r)?r.serialize():new Uint8Array(r.serialize({requireAllSignatures:!1,verifySignatures:!1}));a.push({signedTransaction:f})}else if(t.length>1){let i;for(let r of t){if(r.account?.address!==s(this,l,"f").address)throw new Error("invalid account");if(r.chain){if(!b(r.chain))throw new Error("invalid chain");if(i&&r.chain!==i)throw new Error("conflicting chain");i=r.chain}}let o=t.map(({transaction:r})=>j.deserialize(r)),h=(await s(this,c,"f").request({method:"solana_signAllTransactions",params:{transactions:o}})).transactions.map((r,w)=>{let f=o[w];if(!f)throw new Error("Invalid transactions response");let M=Buffer.from(r,"base64");return A(f)?j.deserialize(new Uint8Array(M)):_.from(M)});a.push(...h.map(r=>({signedTransaction:A(r)?r.serialize():new Uint8Array(r.serialize({requireAllSignatures:!1,verifySignatures:!1}))})))}return a}),P.set(this,async(...t)=>{if(!s(this,l,"f"))throw new Error("not connected");let a=[];if(t.length===1){let{message:i,account:o}=t[0]||{};if(o?.address!==s(this,l,"f").address)throw new Error("invalid account");if(!i)throw new Error("invalid message");let d=await s(this,c,"f").request({method:"solana_signMessage",params:{message:i,pubkey:s(this,l,"f").address}});a.push({signedMessage:i,signature:N.decode(d.signature)})}else if(t.length>1){let i=await Promise.all(t.map(o=>s(this,P,"f").call(this,o)));for(let o of i)a.push(...o)}return a}),y(this,c,e,"f"),this.setProvider(e),q(this)}setProvider(e){y(this,c,e,"f"),y(this,O,"WalletConnect","f"),e.on("connect",()=>s(this,T,"f").call(this)),e.on("disconnect",()=>s(this,U,"f").call(this)),e.on("accountsChanged",()=>s(this,Y,"f").call(this)),e.on("chainChanged",()=>s(this,Y,"f").call(this)),s(this,T,"f").call(this)}};u=new WeakMap,H=new WeakMap,c=new WeakMap,O=new WeakMap,K=new WeakMap,l=new WeakMap,R=new WeakMap,T=new WeakMap,U=new WeakMap,Y=new WeakMap,G=new WeakMap,Z=new WeakMap,Q=new WeakMap,V=new WeakMap,P=new WeakMap,m=new WeakSet,B=function(e,...t){s(this,u,"f")[e]?.forEach(a=>a.apply(null,t))},at=function(e,t){s(this,u,"f")[e]=s(this,u,"f")[e]?.filter(a=>t!==a)};export{J as SolanaWalletConnectStandardWallet};
